!function(e){"use strict";e.keyboard=function(t,a){var i,s=this;s.$el=e(t),s.el=t,s.$el.data("keyboard",s),s.init=function(){s.options=i=e.extend(!0,{},e.keyboard.defaultOptions,a),s.shiftActive=s.altActive=s.metaActive=s.sets=s.capsLock=!1,s.lastKeyset=[!1,!1,!1],s.rows=["","-shift","-alt","-alt-shift"],s.acceptedKeys=[],s.mappedKeys={},e('<!--[if lte IE 8]><script>jQuery("body").addClass("oldie");</script><![endif]--><!--[if IE]><script>jQuery("body").addClass("ie");</script><![endif]-->').appendTo("body").remove(),s.msie=e("body").hasClass("oldie"),s.allie=e("body").hasClass("ie"),s.inPlaceholder=s.$el.attr("placeholder")||"",s.watermark="undefined"!=typeof document.createElement("input").placeholder&&""!==s.inPlaceholder,s.regex=e.keyboard.comboRegex,s.decimal=/^\./.test(i.display.dec)?!0:!1,s.repeatTime=1e3/(i.repeatRate||20),s.temp=e('<input style="position:absolute;left:-9999em;top:-9999em;" type="text" value="testing">').appendTo("body").caret(3,3),s.checkCaret=i.lockInput||3!==s.temp.hide().show().caret().start?!0:!1,s.temp.remove(),s.lastCaret={start:0,end:0},s.temp=["",0,0],e.each("initialized beforeVisible visible hidden canceled accepted beforeClose".split(" "),function(t,a){e.isFunction(i[a])&&s.$el.bind(a+".keyboard",i[a])}),i.alwaysOpen&&(i.stayOpen=!0),e(document).bind("mousedown.keyboard keyup.keyboard touchstart.keyboard",function(t){if(!s.opening&&(s.escClose(t),t.target&&e(t.target).hasClass("ui-keyboard-input"))){var a=e(t.target).data("keyboard");a&&a.options.openOn&&a.focusOn()}}),s.$el.addClass("ui-keyboard-input "+i.css.input).attr({"aria-haspopup":"true",role:"textbox"}),(s.$el.is(":disabled")||s.$el.attr("readonly")&&!s.$el.hasClass("ui-keyboard-lockedinput"))&&s.$el.addClass("ui-keyboard-nokeyboard"),i.openOn&&s.$el.bind(i.openOn+".keyboard",function(){s.focusOn()}),s.watermark||""!==s.$el.val()||""===s.inPlaceholder||""===s.$el.attr("placeholder")||s.$el.addClass("ui-keyboard-placeholder").val(s.inPlaceholder),s.$el.trigger("initialized.keyboard",[s,s.el]),i.alwaysOpen&&s.reveal()},s.focusOn=function(){i.usePreview&&s.$el.is(":visible")&&(s.lastCaret=s.$el.caret()),(!s.isVisible()||i.alwaysOpen)&&(clearTimeout(s.timer),s.reveal())},s.reveal=function(){if(s.opening=!0,e(".ui-keyboard:not(.ui-keyboard-always-open)").hide(),s.$el.is(":disabled")||s.$el.attr("readonly")&&!s.$el.hasClass("ui-keyboard-lockedinput"))return void s.$el.addClass("ui-keyboard-nokeyboard");s.$el.removeClass("ui-keyboard-nokeyboard"),i.openOn&&s.$el.unbind(i.openOn+".keyboard"),"undefined"==typeof s.$keyboard&&s.startup(),e(".ui-keyboard-has-focus").removeClass("ui-keyboard-has-focus"),e(".ui-keyboard-input-current").removeClass("ui-keyboard-input-current"),s.$el.addClass("ui-keyboard-input-current"),s.isCurrent(!0),s.watermark||s.el.value!==s.inPlaceholder||s.$el.removeClass("ui-keyboard-placeholder").val(""),s.originalContent=s.$el.val(),s.$preview.val(s.originalContent),i.acceptValid&&s.checkValid();var t,a;return s.position=i.position,s.position.of=s.position.of||s.$el.data("keyboardPosition")||s.$el,s.position.collision=i.usePreview?s.position.collision||"fit fit":"flip flip",i.resetDefault&&(s.shiftActive=s.altActive=s.metaActive=!1,s.showKeySet()),s.$keyboard.css({position:"absolute",left:0,top:0}),s.$el.trigger("beforeVisible.keyboard",[s,s.el]),s.$keyboard.addClass("ui-keyboard-has-focus").show(),i.usePreview&&s.msie&&("undefined"==typeof s.width&&(s.$preview.hide(),s.width=Math.ceil(s.$keyboard.width()),s.$preview.show()),s.$preview.width(s.width)),e.ui.position&&s.$keyboard.position(s.position),i.initialFocus&&s.$preview.focus(),s.checkDecimal(),s.lineHeight=parseInt(s.$preview.css("lineHeight"),10)||parseInt(s.$preview.css("font-size"),10)+4,i.caretToEnd&&(a=s.originalContent.length,s.lastCaret={start:a,end:a}),s.allie&&(a=s.lastCaret.start||s.originalContent.length,t={start:a,end:a},s.lastCaret||(s.lastCaret=t),0===s.lastCaret.end&&s.lastCaret.start>0&&(s.lastCaret.end=s.lastCaret.start),s.lastCaret.start<0&&(s.lastCaret=t)),setTimeout(function(){s.opening=!1,i.initialFocus&&s.$preview.caret(s.lastCaret.start,s.lastCaret.end),s.$el.trigger("visible.keyboard",[s,s.el])},10),s},s.startup=function(){s.$keyboard=s.buildKeyboard(),s.$allKeys=s.$keyboard.find("button.ui-keyboard-button"),s.preview=s.$preview[0],s.$decBtn=s.$keyboard.find(".ui-keyboard-dec"),s.wheel=e.isFunction(e.fn.mousewheel),s.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46],i.enterNavigation&&s.alwaysAllowed.push(13),s.$preview.bind("keypress.keyboard",function(t){var a=s.lastKey=String.fromCharCode(t.charCode||t.which);if(s.$lastKey=[],s.checkCaret&&(s.lastCaret=s.$preview.caret()),s.capsLock=a>=65&&90>=a&&!t.shiftKey||a>=97&&122>=a&&t.shiftKey?!0:!1,i.restrictInput){if((8===t.which||0===t.which)&&e.inArray(t.keyCode,s.alwaysAllowed))return;-1===e.inArray(a,s.acceptedKeys)&&t.preventDefault()}else if((t.ctrlKey||t.metaKey)&&(97===t.which||99===t.which||118===t.which||t.which>=120&&t.which<=122))return;s.hasMappedKeys&&s.mappedKeys.hasOwnProperty(a)&&(s.lastKey=s.mappedKeys[a],s.insertText(s.lastKey),t.preventDefault()),s.checkMaxLength()}).bind("keyup.keyboard",function(t){switch(t.which){case 9:s.tab&&i.tabNavigation&&!i.lockInput?(s.shiftActive=t.shiftKey,e.keyboard.keyaction.tab(s),s.tab=!1):t.preventDefault();break;case 27:return s.close(),!1}clearTimeout(s.throttled),s.throttled=setTimeout(function(){s.isVisible()&&s.checkCombos()},100),s.checkMaxLength(),e.isFunction(i.change)&&i.change(e.Event("change"),s,s.el),s.$el.trigger("change.keyboard",[s,s.el])}).bind("keydown.keyboard",function(t){switch(t.which){case 9:return i.tabNavigation?(s.tab=!0,!1):(s.tab=!0,!1);case 13:e.keyboard.keyaction.enter(s,null,t);break;case 20:s.shiftActive=s.capsLock=!s.capsLock,s.showKeySet(this);break;case 86:if(t.ctrlKey||t.metaKey){if(i.preventPaste)return void t.preventDefault();s.checkCombos()}}}).bind("mouseup.keyboard touchend.keyboard",function(){s.checkCaret&&(s.lastCaret=s.$preview.caret())}),s.$keyboard.bind("mousedown.keyboard click.keyboard touchstart.keyboard",function(e){e.stopPropagation()}),i.preventPaste&&(s.$preview.bind("contextmenu.keyboard",function(e){e.preventDefault()}),s.$el.bind("contextmenu.keyboard",function(e){e.preventDefault()})),i.appendLocally?s.$el.after(s.$keyboard):s.$keyboard.appendTo("body"),s.$allKeys.bind(i.keyBinding.split(" ").join(".keyboard ")+".keyboard repeater.keyboard",function(t){if(!s.$keyboard.is(":visible"))return!1;var a,r=e.data(this,"key"),n=r.action.split(":")[0];if(s.$preview.focus(),s.$lastKey=e(this),s.lastKey=r.curTxt,s.checkCaret&&s.$preview.caret(s.lastCaret.start,s.lastCaret.end),n.match("meta")&&(n="meta"),e.keyboard.keyaction.hasOwnProperty(n)&&e(this).hasClass("ui-keyboard-actionkey")){if(e.keyboard.keyaction[n](s,this,t)===!1)return!1}else"undefined"!=typeof r.action&&(a=s.lastKey=s.wheel&&!e(this).hasClass("ui-keyboard-actionkey")?r.curTxt:r.action,s.insertText(a),s.capsLock||i.stickyShift||t.shiftKey||(s.shiftActive=!1,s.showKeySet(this)));s.checkCombos(),s.checkMaxLength(),e.isFunction(i.change)&&i.change(e.Event("change"),s,s.el),s.$el.trigger("change.keyboard",[s,s.el]),s.$preview.focus(),s.checkCaret&&s.$preview.caret(s.lastCaret.start,s.lastCaret.end),t.preventDefault()}).bind("mouseenter.keyboard mouseleave.keyboard",function(t){if(s.isCurrent()){var a=this,r=e(this),n=e.data(a,"key");"mouseenter"!==t.type||"password"===s.el.type||r.hasClass(i.css.buttonDisabled)||r.addClass(i.css.buttonHover).attr("title",function(e,t){return s.wheel&&""===t&&s.sets?i.wheelMessage:t}),"mouseleave"===t.type&&(n.curTxt=n.original,n.curNum=0,e.data(a,"key",n),r.removeClass("password"===s.el.type?"":i.css.buttonHover).attr("title",function(e,t){return t===i.wheelMessage?"":t}).find("span").text(n.original))}}).bind("mousewheel.keyboard",function(t,a){if(s.wheel){var i,r=e(this),n=e.data(this,"key");return i=n.layers||s.getLayers(r),n.curNum+=a>0?-1:1,n.curNum>i.length-1&&(n.curNum=0),n.curNum<0&&(n.curNum=i.length-1),n.layers=i,n.curTxt=i[n.curNum],e.data(this,"key",n),r.find("span").text(i[n.curNum]),!1}}).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb",function(t){return"mouseleave"===t.type?e(this).removeClass(i.css.buttonHover):(s.isVisible()&&s.isCurrent()&&s.$preview.focus(),s.checkCaret&&s.$preview.caret(s.lastCaret.start,s.lastCaret.end)),s.mouseRepeat=[!1,""],clearTimeout(s.repeater),!1}).bind("click.keyboard",function(){return!1}).filter(":not(.ui-keyboard-actionkey)").add(".ui-keyboard-tab, .ui-keyboard-bksp, .ui-keyboard-space, .ui-keyboard-enter",s.$keyboard).bind("mousedown.kb touchstart.kb",function(){if(0!==i.repeatRate){var t=e(this);s.mouseRepeat=[!0,t],setTimeout(function(){s.mouseRepeat[0]&&s.mouseRepeat[1]===t&&s.repeatKey(t)},i.repeatDelay)}return!1}),e(window).resize(function(){s.isVisible()&&s.$keyboard.position(s.position)})},s.isVisible=function(){return"undefined"==typeof s.$keyboard?!1:s.$keyboard.is(":visible")},s.insertText=function(e){var t,a,i,r=s.$preview.val(),n=s.$preview.caret(),o=s.$preview.scrollLeft(),c=s.$preview.scrollTop(),l=r.length;n.end<n.start&&(n.end=n.start),n.start>l&&(n.end=n.start=l),"TEXTAREA"===s.preview.tagName&&(s.msie&&"\n"===r.substr(n.start,1)&&(n.start+=1,n.end+=1),i=r.split("\n").length-1,s.preview.scrollTop=i>0?s.lineHeight*i:c),t="bksp"===e&&n.start===n.end?!0:!1,e="bksp"===e?"":e,a=n.start+(t?-1:e.length),o+=parseInt(s.$preview.css("fontSize"),10)*("bksp"===e?-1:1),s.$preview.val(s.$preview.val().substr(0,n.start-(t?1:0))+e+s.$preview.val().substr(n.end)).caret(a,a).scrollLeft(o),s.checkCaret&&(s.lastCaret={start:a,end:a})},s.checkMaxLength=function(){var e,t=s.$preview.val();i.maxLength!==!1&&t.length>i.maxLength&&(e=Math.min(s.$preview.caret().start,i.maxLength),s.$preview.val(t.substring(0,i.maxLength)),s.$preview.caret(e,e),s.lastCaret={start:e,end:e}),s.$decBtn.length&&s.checkDecimal()},s.repeatKey=function(e){e.trigger("repeater.keyboard"),s.mouseRepeat[0]&&(s.repeater=setTimeout(function(){s.repeatKey(e)},s.repeatTime))},s.showKeySet=function(e){var t="",a=(s.shiftActive?1:0)+(s.altActive?2:0);return s.shiftActive||(s.capsLock=!1),s.metaActive?(t=e&&e.name&&/meta/.test(e.name)?e.name:"",""===t?t=s.metaActive===!0?"":s.metaActive:s.metaActive=t,(!i.stickyShift&&s.lastKeyset[2]!==s.metaActive||(s.shiftActive||s.altActive)&&!s.$keyboard.find(".ui-keyboard-keyset-"+t+s.rows[a]).length)&&(s.shiftActive=s.altActive=!1)):!i.stickyShift&&s.lastKeyset[2]!==s.metaActive&&s.shiftActive&&(s.shiftActive=s.altActive=!1),a=(s.shiftActive?1:0)+(s.altActive?2:0),t=0!==a||s.metaActive?""===t?"":"-"+t:"-default",s.$keyboard.find(".ui-keyboard-keyset"+t+s.rows[a]).length?(s.$keyboard.find(".ui-keyboard-alt, .ui-keyboard-shift, .ui-keyboard-actionkey[class*=meta]").removeClass(i.css.buttonAction).end().find(".ui-keyboard-alt")[s.altActive?"addClass":"removeClass"](i.css.buttonAction).end().find(".ui-keyboard-shift")[s.shiftActive?"addClass":"removeClass"](i.css.buttonAction).end().find(".ui-keyboard-lock")[s.capsLock?"addClass":"removeClass"](i.css.buttonAction).end().find(".ui-keyboard-keyset").hide().end().find(".ui-keyboard-keyset"+t+s.rows[a]).show().end().find(".ui-keyboard-actionkey.ui-keyboard"+t).addClass(i.css.buttonAction),void(s.lastKeyset=[s.shiftActive,s.altActive,s.metaActive])):(s.shiftActive=s.lastKeyset[0],s.altActive=s.lastKeyset[1],void(s.metaActive=s.lastKeyset[2]))},s.checkCombos=function(){if(s.isVisible()){var e,t,a,r,n=s.$preview.val(),o=s.$preview.caret(),c=n.length;if(o.end<o.start&&(o.end=o.start),o.start>c&&(o.end=o.start=c),s.msie&&"\n"===n.substr(o.start,1)&&(o.start+=1,o.end+=1),i.useCombos&&(s.msie?n=n.replace(s.regex,function(e,t,a){return i.combos.hasOwnProperty(t)?i.combos[t][a]||e:e}):s.$preview.length&&(a=o.start-(o.start-2>=0?2:0),s.$preview.caret(a,o.end),r=(s.$preview.caret().text||"").replace(s.regex,function(e,t,a){return i.combos.hasOwnProperty(t)?i.combos[t][a]||e:e}),s.$preview.val(s.$preview.caret().replace(r)),n=s.$preview.val())),i.restrictInput&&""!==n){for(a=n,t=s.acceptedKeys.length,e=0;t>e;e++)""!==a&&(r=s.acceptedKeys[e],n.indexOf(r)>=0&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(r)&&(r="\\"+r),a=a.replace(new RegExp(r,"g"),"")));""!==a&&(n=n.replace(a,""))}return o.start+=n.length-c,o.end+=n.length-c,s.$preview.val(n),s.$preview.caret(o.start,o.end),s.preview.scrollTop=s.lineHeight*(n.substring(0,o.start).split("\n").length-1),s.lastCaret={start:o.start,end:o.end},i.acceptValid&&s.checkValid(),n}},s.checkValid=function(){var e=!0;i.validate&&"function"==typeof i.validate&&(e=i.validate(s,s.$preview.val(),!1)),s.$keyboard.find(".ui-keyboard-accept")[e?"removeClass":"addClass"]("ui-keyboard-invalid-input")[e?"addClass":"removeClass"]("ui-keyboard-valid-input")},s.checkDecimal=function(){s.decimal&&/\./g.test(s.preview.value)||!s.decimal&&/\,/g.test(s.preview.value)?s.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(i.css.buttonDefault+" "+i.css.buttonHover).addClass(i.css.buttonDisabled):s.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(i.css.buttonDefault).removeClass(i.css.buttonDisabled)},s.getLayers=function(t){var a,i;return a=t.attr("data-pos"),i=t.closest(".ui-keyboard").find('button[data-pos="'+a+'"]').map(function(){return e(this).find("> span").text()}).get()},s.isCurrent=function(t){var a=e.keyboard.currentKeyboard||!1;return t?a=e.keyboard.currentKeyboard=s.el:t===!1&&a===s.el&&(a=e.keyboard.currentKeyboard=""),a===s.el},s.switchInput=function(t,a){if("function"==typeof i.switchInput)i.switchInput(s,t,a);else{s.$keyboard.hide();var r,n=!1,o=e("button, input, textarea, a").filter(":visible"),c=o.index(s.$el)+(t?1:-1);s.$keyboard.show(),c>o.length-1&&(n=i.stopAtEnd,c=0),0>c&&(n=i.stopAtEnd,c=o.length-1),n||(s.close(a),r=o.eq(c).data("keyboard"),r&&r.options.openOn.length?r.focusOn():o.eq(c).focus())}return!1},s.close=function(t){if(s.isVisible()){clearTimeout(s.throttled);var a=t?s.checkCombos():s.originalContent;if(t&&i.validate&&"function"==typeof i.validate&&!i.validate(s,a,!0)&&(a=s.originalContent,t=!1,i.cancelClose))return;s.isCurrent(!1),s.$el.removeClass("ui-keyboard-input-current ui-keyboard-autoaccepted").addClass(t?t===!0?"":"ui-keyboard-autoaccepted":"").trigger(i.alwaysOpen?"":"beforeClose.keyboard",[s,s.el,t||!1]).val(a).scrollTop(s.el.scrollHeight).trigger(t?"accepted.keyboard":"canceled.keyboard",[s,s.el]).trigger(i.alwaysOpen?"inactive.keyboard":"hidden.keyboard",[s,s.el]).blur(),i.openOn&&(s.timer=setTimeout(function(){s.$el.bind(i.openOn+".keyboard",function(){s.focusOn()}),e(":focus")[0]===s.el&&s.$el.blur()},500)),i.alwaysOpen||s.$keyboard.hide(),s.watermark||""!==s.el.value||""===s.inPlaceholder||s.$el.addClass("ui-keyboard-placeholder").val(s.inPlaceholder),s.$el.trigger("change")}return!!t},s.accept=function(){return s.close(!0)},s.escClose=function(e){if("keyup"===e.type)return 27===e.which?s.close():"";var t=s.isCurrent();!s.isVisible()||i.alwaysOpen&&!t||!i.alwaysOpen&&i.stayOpen&&t&&!s.isVisible()||e.target!==s.el&&t&&(s.allie&&e.preventDefault(),s.close(i.autoAccept?"true":!1))},s.keyBtn=e("<button />").attr({role:"button","aria-disabled":"false",tabindex:"-1"}).addClass("ui-keyboard-button"),s.addKey=function(t,a,r){var n,o,c,l,d,u=r===!0?t:i.display[a]||t,p=r===!0?t.charCodeAt(0):t;return/\(.+\)/.test(u)&&(l=u.replace(/\(([^()]+)\)/,""),c=u.match(/\(([^()]+)\)/)[1],u=l,d=l.split(":"),l=""!==d[0]&&d.length>1?d[0]:l,s.mappedKeys[c]=l),d=u.split(":"),""===d[0]&&""===d[1]&&(u=":"),u=""!==d[0]&&d.length>1?e.trim(d[0]):u,n=d.length>1?e.trim(d[1]).replace(/_/g," ")||"":"",o=u.length>1?" ui-keyboard-widekey":"",o+=r?"":" ui-keyboard-actionkey",s.keyBtn.clone().attr({"data-value":u,name:p,"data-pos":s.temp[1]+","+s.temp[2],title:n}).data("key",{action:t,original:u,curTxt:u,curNum:0}).addClass("ui-keyboard-"+p+o+" "+i.css.buttonDefault).html("<span>"+u+"</span>").appendTo(s.temp[0])},s.buildKeyboard=function(){var t,a,r,n,o,c,l,d,u=0,p=e("<div />").addClass("ui-keyboard "+i.css.container+(i.alwaysOpen?" ui-keyboard-always-open":"")).attr({role:"textbox"}).hide();return i.usePreview?(s.$preview=s.$el.clone(!1).removeAttr("id").removeClass("ui-keyboard-placeholder ui-keyboard-input").addClass("ui-keyboard-preview "+i.css.input).attr("tabindex","-1").show(),e("<div />").addClass("ui-keyboard-preview-wrapper").append(s.$preview).appendTo(p)):(s.$preview=s.$el,i.position.at=i.position.at2),i.lockInput&&s.$preview.addClass("ui-keyboard-lockedinput").attr({readonly:"readonly"}),"custom"!==i.layout&&e.keyboard.layouts.hasOwnProperty(i.layout)||(i.layout="custom",e.keyboard.layouts.custom=i.customLayout||{"default":["{cancel}"]}),e.each(e.keyboard.layouts[i.layout],function(b,y){if(""!==b)for(u++,r=e("<div />").attr("name",b).addClass("ui-keyboard-keyset ui-keyboard-keyset-"+b).appendTo(p)["default"===b?"show":"hide"](),a=0;a<y.length;a++){for(o=e.trim(y[a]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}"),l=o.split(/\s+/),c=0;c<l.length;c++)if(s.temp=[r,a,c],n=!1,0!==l[c].length)if(/^\{\S+\}$/.test(l[c])){if(t=l[c].match(/^\{(\S+)\}$/)[1].toLowerCase(),/\!\!/.test(t)&&(t=t.replace("!!",""),n=!0),/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/.test(t)&&(d=parseFloat(t.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/)[1]||0),e("<span>&nbsp;</span>").width(t.match("px")?d+"px":2*d+"em").addClass("ui-keyboard-button ui-keyboard-spacer").appendTo(r)),/^meta\d+\:?(\w+)?/.test(t)){s.addKey(t,t);continue}switch(t){case"a":case"accept":s.addKey("accept",t).addClass(i.css.buttonAction);break;case"alt":case"altgr":s.addKey("alt","alt");break;case"b":case"bksp":s.addKey("bksp",t);break;case"c":case"cancel":s.addKey("cancel",t).addClass(i.css.buttonAction);break;case"combo":s.addKey("combo","combo").addClass(i.css.buttonAction);break;case"dec":s.acceptedKeys.push(s.decimal?".":","),s.addKey("dec","dec");break;case"e":case"enter":s.addKey("enter",t).addClass(i.css.buttonAction);break;case"empty":s.addKey(""," ").addClass(i.css.buttonDisabled).attr("aria-disabled",!0);break;case"s":case"shift":s.addKey("shift",t);break;case"sign":s.acceptedKeys.push("-"),s.addKey("sign","sign");break;case"space":s.acceptedKeys.push(" "),s.addKey("space","space");break;case"t":case"tab":s.addKey("tab",t);break;default:e.keyboard.keyaction.hasOwnProperty(t)&&s.addKey(t,t)[n?"addClass":"removeClass"](i.css.buttonAction)}}else s.acceptedKeys.push(l[c].split(":")[0]),s.addKey(l[c],l[c],!0);r.find(".ui-keyboard-button:last").after('<br class="ui-keyboard-button-endrow">')}}),u>1&&(s.sets=!0),s.hasMappedKeys=!e.isEmptyObject(s.mappedKeys),p},s.destroy=function(){e(document).unbind("mousedown.keyboard keyup.keyboard touchstart.keyboard"),s.$keyboard&&s.$keyboard.remove();var t=e.trim(i.openOn+" accepted beforeClose canceled change contextmenu hidden initialized keydown keypress keyup visible").split(" ").join(".keyboard ");s.$el.removeClass("ui-keyboard-input ui-keyboard-lockedinput ui-keyboard-placeholder ui-keyboard-notallowed ui-keyboard-always-open "+i.css.input).removeAttr("aria-haspopup").removeAttr("role").unbind(t+".keyboard").removeData("keyboard")},s.init()},e.keyboard.keyaction={accept:function(e){return e.close(!0),!1},alt:function(e,t){e.altActive=!e.altActive,e.showKeySet(t)},bksp:function(e){e.insertText("bksp")},cancel:function(e){return e.close(),!1},clear:function(e){e.$preview.val("")},combo:function(e){var t=!e.options.useCombos;return e.options.useCombos=t,e.$keyboard.find(".ui-keyboard-combo")[t?"addClass":"removeClass"](e.options.css.buttonAction),t&&e.checkCombos(),!1},dec:function(e){e.insertText(e.decimal?".":",")},"default":function(e,t){e.shiftActive=e.altActive=e.metaActive=!1,e.showKeySet(t)},enter:function(t,a,i){var s=t.el.tagName,r=t.options;return i.shiftKey?r.enterNavigation?t.switchInput(!i[r.enterMod],!0):t.close(!0):r.enterNavigation&&("TEXTAREA"!==s||i[r.enterMod])?t.switchInput(!i[r.enterMod],r.autoAccept?"true":!1):void("TEXTAREA"===s&&e(i.target).closest("button").length&&t.insertText(" \n"))},lock:function(e,t){e.lastKeyset[0]=e.shiftActive=e.capsLock=!e.capsLock,e.showKeySet(t)},meta:function(t,a){t.metaActive=e(a).hasClass(t.options.css.buttonAction)?!1:!0,t.showKeySet(a)},next:function(e){return e.switchInput(!0,e.options.autoAccept),!1},prev:function(e){return e.switchInput(!1,e.options.autoAccept),!1},shift:function(e,t){e.lastKeyset[0]=e.shiftActive=!e.shiftActive,e.showKeySet(t)},sign:function(e){/^\-?\d*\.?\d*$/.test(e.$preview.val())&&e.$preview.val(-1*e.$preview.val())},space:function(e){e.insertText(" ")},tab:function(e){var t=e.el.tagName,a=e.options;return"INPUT"===t?a.tabNavigation?e.switchInput(!e.shiftActive,!0):!1:void e.insertText("	")}},e.keyboard.layouts={alpha:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}","{tab} ä å é ® þ ü ú í ó ö « » ¬","á ß ð f g h j k ø ¶ ´ {enter}","{shift} æ x © v b ñ µ ç > ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}","{tab} Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦","Ä § Ð F G H J K Ø ° ¨ {enter}","{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"]},dvorak:{"default":["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{"default":["= ( ) {b}","{clear} / * -","7 8 9 +","4 5 6 {sign}","1 2 3 %","0 . {a} {c}"]}},e.keyboard.defaultOptions={layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},usePreview:!0,alwaysOpen:!1,initialFocus:!0,stayOpen:!1,display:{a:"✔:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"Alt:⌥ AltGr",b:"⌫:Backspace",bksp:"Bksp:Backspace",c:"✖:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"ö:Toggle Combo Keys",dec:".:Decimal",e:"⏎:Enter",empty:" ",enter:"Enter:Enter ⏎",lock:"Lock:⇪ Caps Lock",next:"Next ⇨",prev:"⇦ Prev",s:"⇧:Shift",shift:"Shift:Shift",sign:"±:Change Sign",space:"&nbsp;:Space",t:"⇥:Tab",tab:"⇥ Tab:Tab"},wheelMessage:"Use mousewheel to see other keys",css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonDisabled:"ui-state-disabled"},autoAccept:!1,lockInput:!1,restrictInput:!1,acceptValid:!1,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,stickyShift:!0,preventPaste:!1,caretToEnd:!1,maxLength:!1,repeatDelay:500,repeatRate:20,resetDefault:!1,openOn:"focus",keyBinding:"mousedown touchstart",useCombos:!0,combos:{"`":{a:"à",A:"À",e:"è",E:"È",i:"ì",I:"Ì",o:"ò",O:"Ò",u:"ù",U:"Ù",y:"ỳ",Y:"Ỳ"},"'":{a:"á",A:"Á",e:"é",E:"É",i:"í",I:"Í",o:"ó",O:"Ó",u:"ú",U:"Ú",y:"ý",Y:"Ý"},'"':{a:"ä",A:"Ä",e:"ë",E:"Ë",i:"ï",I:"Ï",o:"ö",O:"Ö",u:"ü",U:"Ü",y:"ÿ",Y:"Ÿ"},"^":{a:"â",A:"Â",e:"ê",E:"Ê",i:"î",I:"Î",o:"ô",O:"Ô",u:"û",U:"Û",y:"ŷ",Y:"Ŷ"},"~":{a:"ã",A:"Ã",e:"ẽ",E:"Ẽ",i:"ĩ",I:"Ĩ",o:"õ",O:"Õ",u:"ũ",U:"Ũ",y:"ỹ",Y:"Ỹ",n:"ñ",N:"Ñ"}},validate:function(){return!0}},e.keyboard.comboRegex=/([`\'~\^\"ao])([a-z])/gim,e.keyboard.currentKeyboard="",e.fn.keyboard=function(t){return this.each(function(){e(this).data("keyboard")||new e.keyboard(this,t)})},e.fn.getkeyboard=function(){return this.data("keyboard")}}(jQuery),function(e,t,a,i){"use strict";e.fn.caret=function(e,s){if("undefined"==typeof this[0]||this.is(":hidden")||"hidden"===this.css("visibility"))return this;var r,n,o,c,l,d,u,p,b,y=document.selection,h=this[0],k=h.scrollTop,f="undefined"!=typeof h.selectionStart;return"number"==typeof e&&"number"==typeof s&&(n=e,c=s),"undefined"!=typeof n?(f?(h.selectionStart=n,h.selectionEnd=c):(l=h.createTextRange(),l.collapse(!0),l.moveStart("character",n),l.moveEnd("character",c-n),l.select()),(this.is(":visible")||"hidden"!==this.css("visibility"))&&this.focus(),h.scrollTop=k,this):(f?(r=h.selectionStart,o=h.selectionEnd):"TEXTAREA"===h.tagName?(b=this.val(),d=y[a](),u=d[i](),u.moveToElementText(h),u.setEndPoint("EndToEnd",d),r=u.text.replace(/\r/g,"\n")[t],o=r+d.text.replace(/\r/g,"\n")[t]):(b=this.val().replace(/\r/g,"\n"),d=y[a]()[i](),d.moveEnd("character",b[t]),r=""===d.text?b[t]:b.lastIndexOf(d.text),d=y[a]()[i](),d.moveStart("character",-b[t]),o=d.text[t]),p=(h.value||"").substring(r,o),{start:r,end:o,text:p,replace:function(e){return h.value.substring(0,r)+e+h.value.substring(o,h.value[t])}})}}(jQuery,"length","createRange","duplicate");